<!doctype html><html lang=en-us><head><title>opencanary honey pot - part of my zero day initiative // Musings from Etienne</title>
<link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.143.1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Etienne Munnich"><meta name=description content><link rel=stylesheet href=/css/main.min.5b1fcc8902588589c4767187402a3c29f8b8d7a6fdef6d9f8f77045bb0d14fee.css><meta name=twitter:card content="summary"><meta name=twitter:title content="opencanary honey pot - part of my zero day initiative"><meta name=twitter:description content="opencanary honey pot - part of my zero day initiative It’s been a while :] But back to the grind stone, my nextr 1 day project was based out of curiousity about what was happening on my DSL router as as an attack surface after reading about common attacks to type home routers.
Fair warning - don’t open your router up to the net without understanding the risks - you’re letting the world into your home. I used a spare router…"><meta property="og:url" content="https://etiennemunnich.github.io/posts/opencanary-honey-pot/"><meta property="og:site_name" content="Musings from Etienne"><meta property="og:title" content="opencanary honey pot - part of my zero day initiative"><meta property="og:description" content="opencanary honey pot - part of my zero day initiative It’s been a while :] But back to the grind stone, my nextr 1 day project was based out of curiousity about what was happening on my DSL router as as an attack surface after reading about common attacks to type home routers.
Fair warning - don’t open your router up to the net without understanding the risks - you’re letting the world into your home. I used a spare router…"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-09-23T00:00:00+00:00"><meta property="article:modified_time" content="2019-09-23T00:00:00+00:00"><meta property="article:tag" content="Opencanary"><meta property="article:tag" content="Honeypot"></head><body><header class=app-header><a href=/><img class=app-header-avatar src=/avatar.jpg alt="Etienne Munnich"></a>
<span class=app-header-title>Musings from Etienne</span><nav class=app-header-menu><a class=app-header-menu-item href=/posts/>Posts</a>
-
<a class=app-header-menu-item href=/about/>About</a></nav><p>My blog covering mostly technical subjects around web application security, serverless architectures, distributed systems and other cloud computing topics.</p><div class=app-header-social><a href=https://github.com/EtienneMunnich target=_blank rel="noreferrer noopener me"><svg class="icon icon-github" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>github</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=https://www.linkedin.com/in/etiennemunnich/ target=_blank rel="noreferrer noopener me"><svg class="icon icon-linkedin" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>linkedin</title><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</a><a href=https://topmate.io/etienne_munnich target=_blank rel="noreferrer noopener me"><svg class="icon icon-globe" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>globe</title><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3.0 014 10 15.3 15.3.0 01-4 10A15.3 15.3.0 018 12a15.3 15.3.0 014-10z"/></svg>
</a><a href=https://discord.com/channels/907076068098334800/907076068098334803 target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-link"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>opencanary honey pot - part of my zero day initiative</h1><div class=post-meta><div><svg class="icon icon-calendar" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
Sep 23, 2019</div><div><svg class="icon icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
3 min read</div><div><svg class="icon icon-tag" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
<a class=tag href=/tags/opencanary/>Opencanary</a>
<a class=tag href=/tags/honeypot/>Honeypot</a></div></div></header><div class=post-content><h1 id=opencanary-honey-pot---part-of-my-zero-day-initiative>opencanary honey pot - part of my zero day initiative</h1><p>It’s been a while :] But back to the grind stone, my nextr 1 day project was based out of curiousity about what was happening on my DSL router as as an attack surface after reading about common attacks to type home <a href=https://securityledger.com/2019/08/huge-survey-of-firmware-finds-no-security-gains-in-15-years/>routers</a>.</p><p>Fair warning - don’t open your router up to the net without understanding the risks - you’re letting the world into your home. I used a spare router&mldr;</p><h2 id=the-plan>The plan</h2><p>So the plan was to grab inbound UDP and TCP connection data to ports 80(HTTP), 22(SSH) and 21(FTP). Unfortunately I couldn’t capture ICMP due to the router used (locked config by upstream provider)</p><p>Further ideas would be to capture any scans within my network for SMB(Samba / File Shares) and all DNS queries as a trip wire as to check if someone is in the network.</p><p>This is where <a href=https://opencanary.readthedocs.io/en/latest/>OpenCanary</a> was of interest for me, I wanted to gather data to see what type of attacks where occurring, from where and gather a user/password list of all the attack/discovery attempts. OpenCanary allows open to get going pretty quickly, it simulates services so that attackers attempt to connect which is then logged in detail&mldr;.</p><h2 id=why-use-a-honeypot>Why use a honeypot?</h2><p>The attempts to connect to ‘fake’ services allows SecOps (seucity operations) staff to understand what attackers are trying to do and potentially block IP address, put checks in place in production systems, prevent username and/or password combinations from being used on networks and the internet.</p><p>OpenCanary can easily be used within a LAN or on the internet, attackers could already be in your network :[&mldr;</p><h2 id=equipment-used-for-my-test>Equipment used for my test</h2><p>I used stock kit provided by my ISP, with only the and decided to dust of my Raspberry Pi (rpi) with the out the box rasbian OS. This was the only item connected as I don’t want the world having the opertunity to have access to my home network.</p><p>Oversimplified install steps:</p><ul><li>Configure router to port forward, disable any DDOS, port triggering</li><li>Rasberry Pi - install rasbian, configure sshd to use port 222 and configure ufw, limit port 222 to listen to a particular IP from which admin actions will be done, allow port 80, 21, 22 access from any ip (for the honey pot to capture)</li><li>Install OpenCanary and configure the services in /etc/opencanaryd/opencanary.conf</li><li>Configure opencanaryd to start at boot using your prefer method&mldr;</li></ul><h2 id=logs>Logs</h2><p>I started receiving attempts against all ports immediately, the logs for</p><ul><li>web services land in /var/tmp/opencanary.log</li><li>samba/SMB land in /var/log/samba-audit.log&mldr;</li></ul><pre tabindex=0><code class=language-code data-lang=code>{&#34;dst_host&#34;: &#34;10.0.0.2&#34;, &#34;dst_port&#34;: &#34;22&#34;, &#34;local_time&#34;: &#34;2019-09-01 13:13:36.569491&#34;, &#34;logdata&#34;: {&#34;DF&#34;: &#34;&#34;, &#34;ID&#34;:&#34;34943&#34;, &#34;IN&#34;: &#34;xxxx&#34;, &#34;LEN&#34;: &#34;60&#34;, &#34;MAC&#34;: &#34;zz:zz:z3:3z:zz:11:11:11:00:22:44:17:28:00&#34;, &#34;OUT&#34;: &#34;&#34;, &#34;PREC&#34;: &#34;0x00&#34;, &#34;PROTO&#34;: &#34;TCP&#34;, &#34;RES&#34;: &#34;0x00&#34;, &#34;SYN&#34;: &#34;&#34;, &#34;TOS&#34;: &#34;0x00&#34;, &#34;TTL&#34;: &#34;42&#34;, &#34;URGP&#34;: &#34;0&#34;, &#34;WINDOW&#34;: &#34;14440&#34;}, &#34;logtype&#34;: 5001, &#34;node_id&#34;: &#34;my-rpi-canary&#34;, &#34;src_host&#34;: &#34;11.11.112.71&#34;, &#34;src_port&#34;: &#34;60831&#34;}
{&#34;dst_host&#34;: &#34;10.0.0.2&#34;, &#34;dst_port&#34;: 22, &#34;local_time&#34;: &#34;2019-09-01 13:13:37.530184&#34;, &#34;logdata&#34;: {&#34;SESSION&#34;: &#34;603&#34;}, &#34;logtype&#34;: 4000, &#34;node_id&#34;: &#34;my-rpi-canary&#34;, &#34;src_host&#34;: &#34;11.11.112.71&#34;, &#34;src_port&#34;: 60831}
{&#34;dst_host&#34;: &#34;10.0.0.2&#34;, &#34;dst_port&#34;: 22, &#34;local_time&#34;: &#34;2019-09-01 13:13:41.151453&#34;, &#34;logdata&#34;: {&#34;LOCALVERSION&#34;: &#34;SSH-2.0-OpenSSH_5.1p1 Debian-4&#34;, &#34;REMOTEVERSION&#34;: &#34;SSH-2.0-PUTTY&#34;}, &#34;logtype&#34;: 4001, &#34;node_id&#34;: &#34;my-rpi-canary&#34;, &#34;src_host&#34;: &#34;11.11.112.71&#34;, &#34;src_port&#34;: 60831}
{&#34;dst_host&#34;: &#34;10.0.0.2&#34;, &#34;dst_port&#34;: 22, &#34;local_time&#34;: &#34;2019-09-01 13:13:43.225079&#34;, &#34;logdata&#34;: {&#34;LOCALVERSION&#34;: &#34;SSH-2.0-OpenSSH_5.1p1 Debian-4&#34;, &#34;PASSWORD&#34;: &#34;daniel&#34;, &#34;REMOTEVERSION&#34;: &#34;SSH-2.0-PUTTY&#34;, &#34;USERNAME&#34;: &#34;root&#34;}, &#34;logtype&#34;:4002, &#34;node_id&#34;: &#34;my-rpi-canary&#34;, &#34;src_host&#34;: &#34;11.11.112.71&#34;, &#34;src_port&#34;: 60831} 
</code></pre><p>There is an ability to push alerts to Slack and push logs using the <a href=https://opencanary.readthedocs.io/en/latest/starting/correlator.html>OpenCanary Correlator</a>, more on this soon.</p></div><div class=post-footer></div></article></main></body></html>